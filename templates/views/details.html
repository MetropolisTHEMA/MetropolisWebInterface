{% extends 'index_project_details.html' %}>
{% block title %} Network {% endblock title %}

{% block content %}
{% block messages %}
{% if messages %}
  <ul class="messages">
    {% for message in messages %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endfor %}
  </ul>
{% endif %}
{% endblock %}

<div class="row">
	<div class="col-md">
		<div class="card card-body">
      {% if roadnetwork %}
        <h5>Network name : {{roadnetwork.name}}</h5>
  			<hr>
  			<a class="btn btn-outline-info  btn-sm btn-block" href="{% url 'roadtype' roadnetwork.pk %}">Create Road Type</a>
        <a class="btn btn-outline-info  btn-sm btn-block" href="{% url 'upload_road' roadnetwork.pk %}">Import Road Type</a>
  			<a class="btn btn-outline-info  btn-sm btn-block" href="{% url 'upload_node' roadnetwork.pk %}">Import Node</a>
  			<a class="btn btn-outline-info  btn-sm btn-block" href="{% url 'upload_edge' roadnetwork.pk %}">Import Edge</a>

        {% elif zoneset %}
  			<h5>Zone set name : {{zoneset.name}}</h5>
  			<hr>
    			<a class="btn btn-outline-info  btn-sm btn-block"
            href="{% url 'update_zoneset' zoneset.pk %}">Update zone set</a>
          <a class="btn btn-outline-info  btn-sm btn-block"
           href="{% url 'upload_zone' zoneset.pk %}">Import zone</a>

          {% elif od_matrix %}
    			<h5>OD matrix name : {{od_matrix.name}}</h5>
    			<hr>
      			<a class="btn btn-outline-info  btn-sm btn-block"
              href="{% url 'update_od_matrix' od_matrix.pk %}">Update OD matrix</a>
            <a class="btn btn-outline-info  btn-sm btn-block"
             href="{% url 'upoload_od_pair' od_matrix.pk %}">Import OD Pair</a>

      {% endif %}
		</div>

	</div>

	<div class="col-md">
		<div class="card card-body">
			<h5>Owner Information</h5>
			<hr>
			<p>Name: {{user.username}}</p>
			<p>Email: {{user.email}} </p>
		</div>
	</div>

	<div class="col-md">
		<div class="card card-body">
      {% if roadnetwork %}
        <h5>Network attributes</h5>
  			<hr>
  			<p>Number of Nodes : {{total_nodes}}</p>
  			<p>Number of Edges : {{total_edges}} </p>

      {% elif zoneset %}
  			<h5>Zone set attributes</h5>
  			<hr>
  			<p>Zone set tag : {{zoneset.tags}}</p>
  			<p>Zone set comment : {{zoneset.comment}} </p>

        {% elif od_matrix %}
    			<h5>OD matrix attributes</h5>
    			<hr>
    			<p>OD matrix tag : {{od_matrix.tags}}</p>
    			<p>OD matrix comment: {{od_matrix.comment}} </p>

      {% endif %}
		</div>
	</div>
	<hr>
</div>

{% if tasks %}
<div class="row">
	<h5>// Last Tasks</h5>
	<div class="col-md">
		<div class="card card-body">
			<table class="table table-sm table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th>Start date</th>
						<th>Description</th>
						<th>Status</th>
						<th>Time taken</th>
                        <th>Details</th>
					</tr>
				</thead>

				<tbody>
					{% for task in tasks %}
					<tr>
						<td>{{task.start_date}}</td>
						<td>{{task.description}}</td>
                        <td>{{task.get_status}}</td>
                        <td>{% if task.time_taken %}{{task.time_taken}}{% endif %}</td>
                        <td>
                            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#taskModal{{ task.id }}">
                                Details
                            </button>
                        </td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
{% endif %}

{% if roadnetwork %}
<a href="{% url 'project_details' roadnetwork.project_id %}">Back</a>
{% endif %}

{% for task in tasks %}
<div class="modal fade" id="taskModal{{task.id}}" tabindex="-1" aria-labelledby="taskModalLabel{{task.id}}" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title" id="taskModalLabel{{task.id}}">{{ task.description }}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <dl class="row">
              <dt class="col-sm-3">Start date</dt>
              <dd class="col-sm-9">{{ task.start_date }}</dd>

              <dt class="col-sm-3">Status</dt>
              <dd class="col-sm-9">{{ task.get_status }}</dd>

              {% if task.time_taken %}
              <dt class="col-sm-3">Time taken</dt>
              <dd class="col-sm-9">{{ task.time_taken }}</dd>
              {% endif %}

              {% if task.result %}
              <dt class="col-sm-3">Result</dt>
              <dd class="col-sm-9">{{ task.result | linebreaks }}</dd>
              {% endif %}
          </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
{% endfor %}

{% endblock %}
